/*
 * Academic License - for use in teaching, academic research, and meeting
 * course requirements at degree granting institutions only.  Not for
 * government, commercial, or other organizational use.
 *
 * myNeuralNetworkBasedOnPCA.c
 *
 * Code generation for function 'myNeuralNetworkBasedOnPCA'
 *
 */

/* Include files */
#include "rt_nonfinite.h"
#include "myNeuralNetworkBasedOnPCA.h"

/* Function Definitions */
void myNeuralNetworkBasedOnPCA(const double x1[8], double b_y1[25])
{
  int k;
  int xoffset;
  double z1[25];
  double b_z1[200];
  double c[200];
  static const double w[200] = { 3.3918730076065766, 2.6319785162892386,
    -0.21531432196922665, 0.50431079835559323, -2.4022399662717193,
    5.3287277910334376, 3.5650163141812854, 5.0269065312574437,
    -2.3437592320680674, -3.711371760145624, 9.7957932955258773,
    6.6212242704867439, 7.1318879351101323, 1.1466279719838655,
    -4.5201935520527625, 11.23157298471274, 1.461416478976501,
    -3.2961427174843765, -4.6747212720147, -4.826349721645582, 12.30127900396373,
    5.4955221470845617, 2.4768303349654825, -3.8431117864785858,
    -5.0129058140782234, 1.1665170709930615, 3.7686025230947848,
    5.2207871325670361, 9.3277184824841477, 6.1030478698439463,
    0.56539520672671517, 6.1324611093112589, 13.526521813896641,
    5.2754407984361755, 3.0434490479899261, -0.0688803961037866,
    -4.2602303110670361, 8.4339334342477272, 10.832918796404037,
    0.36424894169473532, -6.4781883987340247, -3.20208830988957,
    -2.99216422507514, -2.1882189712759086, -1.0025255379308251,
    -9.6940395947688653, -7.175513249747171, -5.0997566381373485,
    -2.6632564474246836, -2.0281796928576363, 7.5527371305550162,
    5.4882930349771533, 0.48340703570179405, -4.95867798915627,
    -3.1511779015360046, 4.9930937040929173, 0.94762843929480722,
    -10.953501598060608, -4.8861865555897435, -1.7782597883364215,
    1.4858665337962804, -1.0506162682572746, -3.2989389189954936,
    -8.8353514853523674, -0.56762516808224572, -5.5652261887877774,
    0.85035004386882673, -0.099201757966178181, 0.19426326102353414,
    -0.14282376214116177, -10.694549777446014, -6.6827652481880833,
    -3.1830991302295173, -0.043593535165374245, -0.079110064941349978,
    -1.9191296496473644, -2.956807464300379, -2.9848296901666762,
    -1.3891498427093167, -2.1522074931497421, 1.7749851523657856,
    -0.67324446965837081, 3.9053325042406537, 0.92773101922118673,
    -1.1057442023282458, 6.8271803815644949, 0.43485489564140617,
    3.8421913529425415, 1.6716890460970706, 0.3500680945692935,
    0.42192850265999882, -0.9116342744216781, -0.040845135637929908,
    1.2432259442826301, 1.1163886229144182, -5.2869660967775971,
    -4.5394941236550075, -2.415190252679436, 0.51942048951336073,
    1.8387685368380207, 0.9191148705156944, -1.9257954863572124,
    -0.67150046668587715, 0.54997730081752316, 3.377392263266783,
    0.87966366479442815, -2.933663894889678, -3.8855084074181283,
    2.0619544353989592, 3.713057393809168, 0.90564812516015025,
    2.2080214185128675, -4.84784049911872, -0.30577373744165631,
    2.6925201879797314, 1.7734056758031953, 1.1018329478776019,
    -1.2665530092030206, -1.4045982676720223, 0.78938817977097586,
    -1.7659669159918243, -2.4037074284782363, -0.81700104742862534,
    -1.3581547086072037, -1.2496587036831355, 0.74749895020823165,
    -1.3730828319673709, -0.68091907558024845, 1.4546138817902599,
    0.2078085065851927, -0.26571800485571123, -0.59718879415378878,
    3.4730042802268866, 0.003708388495394184, -1.1052487732358312,
    -1.6397760801015777, 2.03665298965997, -0.14537468315367402,
    2.6690703532060835, -2.5945570972682948, -0.62845458687138811,
    3.445268931088914, 2.1277157004186904, -0.003538503488318287,
    -2.20373246014557, -5.4117268817736521, -2.835789349107217,
    0.72514166041537886, 1.0350653817712208, -1.6412818634330859,
    3.9199768290754489, -0.9132485444783518, -3.0136851753906413,
    -0.65276123845536671, -1.3465881129859345, 0.44964943667724655,
    -2.1006603604726095, 4.6883416116583945, 2.5498230295372575,
    -0.56919587048253562, -1.4294863787267715, -1.5979181867416172,
    -0.69886712096717285, 3.913481046334228, 0.38077660540073172,
    -1.4189522818570222, -0.42971104580928288, -0.38004227297519017,
    -0.0888687576829304, 0.4683819443157175, 2.4961502615992153,
    2.2893969774107603, 0.2648816945300223, -0.19874954151419044,
    0.63706150062241274, -0.017435091242629604, 1.0328142372256184,
    0.11510600376261809, -0.66842472179477719, -1.8999602424187607,
    -1.325135474961413, 0.7949857398994189, 1.7403258343196728,
    0.60677945360672347, -1.2241897716112977, -2.2977126632551217,
    2.1975514998713366, 0.5703869167444926, 0.8562381442263266,
    0.65420220346018565, 2.1696393734324975, 1.5364976208185719,
    -1.7870567257075725, 0.14424765300477432, 1.3016725320174429,
    -1.3974747430908911, -2.8896455706282058, -0.59520186517813545,
    -0.85949294009340027, 1.9005297534908816 };

  int j;
  boolean_T nanInd;
  double c_z1;
  boolean_T b[25];
  boolean_T exitg1;

  /* MYNEURALNETWORKBASEDONPCA neural network simulation function. */
  /*  */
  /*  Generated by Neural Network Toolbox function genFunction, 23-Nov-2017 15:11:17. */
  /*   */
  /*  [y1] = myNeuralNetworkBasedOnPCA(x1) takes these arguments: */
  /*    x = 8xQ matrix, input #1 */
  /*  and returns: */
  /*    y = 25xQ matrix, output #1 */
  /*  where Q is the number of samples. */
  /*  ===== NEURAL NETWORK CONSTANTS ===== */
  /*  Layer 1 */
  /*  ===== SIMULATION ======== */
  /*  Input 1 */
  /*  no processing */
  /*  Layer 1 */
  /*  ===== MODULE FUNCTIONS ======== */
  /*  Negative Distance Weight Function */
  for (k = 0; k < 8; k++) {
    for (xoffset = 0; xoffset < 25; xoffset++) {
      c[xoffset + 25 * k] = w[xoffset + 25 * k] - x1[k];
    }
  }

  for (k = 0; k < 200; k++) {
    b_z1[k] = c[k] * c[k];
  }

  memcpy(&z1[0], &b_z1[0], 25U * sizeof(double));
  for (k = 0; k < 7; k++) {
    xoffset = (k + 1) * 25;
    for (j = 0; j < 25; j++) {
      z1[j] += b_z1[xoffset + j];
    }
  }

  /*  Competitive Transfer Function */
  for (k = 0; k < 25; k++) {
    c_z1 = -sqrt(z1[k]);
    b[k] = rtIsNaN(c_z1);
    z1[k] = c_z1;
  }

  nanInd = false;
  k = 0;
  exitg1 = false;
  while ((!exitg1) && (k < 25)) {
    if (b[k]) {
      nanInd = true;
      exitg1 = true;
    } else {
      k++;
    }
  }

  memset(&b_y1[0], 0, 25U * sizeof(double));
  xoffset = 1;
  c_z1 = z1[0];
  j = 0;
  if (rtIsNaN(z1[0])) {
    k = 2;
    exitg1 = false;
    while ((!exitg1) && (k < 26)) {
      xoffset = k;
      if (!rtIsNaN(z1[k - 1])) {
        c_z1 = z1[k - 1];
        j = k - 1;
        exitg1 = true;
      } else {
        k++;
      }
    }
  }

  if (xoffset < 25) {
    while (xoffset + 1 < 26) {
      if (z1[xoffset] > c_z1) {
        c_z1 = z1[xoffset];
        j = xoffset;
      }

      xoffset++;
    }
  }

  b_y1[j] = 1.0;
  xoffset = 0;
  for (j = 0; j < 1; j++) {
    if (nanInd) {
      xoffset++;
    }
  }

  if (0 <= xoffset - 1) {
    for (xoffset = 0; xoffset < 25; xoffset++) {
      b_y1[xoffset] = rtNaN;
    }
  }

  /*  Output 1 */
}

/* End of code generation (myNeuralNetworkBasedOnPCA.c) */
